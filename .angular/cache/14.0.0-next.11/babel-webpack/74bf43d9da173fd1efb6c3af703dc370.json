{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Student/Documents/SWE/kundeweb/kundeweb/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _UpdateKundeComponent_instances, _UpdateKundeComponent_setProps, _UpdateKundeComponent_handleFindError, _UpdateKundeComponent_handleUpdateResult, _UpdateKundeComponent_navigateHome;\n\nimport { __classPrivateFieldGet } from \"tslib\";\n/* eslint-disable @typescript-eslint/consistent-type-imports */\n\nimport { FindError, UpdateError } from '../shared';\n/* eslint-enable @typescript-eslint/consistent-type-imports */\n\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport log from 'loglevel';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../shared/error-message.component\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"./update-nachname.component\";\n\nfunction UpdateKundeComponent_section_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"section\", 2)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 3)(4, \"form\", 4);\n    i0.ɵɵlistener(\"submit\", function UpdateKundeComponent_section_0_Template_form_submit_4_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onSubmit());\n    });\n    i0.ɵɵelement(5, \"hs-update-nachname\", 5);\n    i0.ɵɵelementStart(6, \"div\", 6)(7, \"div\", 7)(8, \"button\", 8)(9, \"i\", 9);\n    i0.ɵɵtext(10, \"check\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"span\", 10);\n    i0.ɵɵtext(12, \"Stammdaten aktualisieren\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Kunde \", ctx_r0.kunde.id, \":\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.updateForm);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"updateForm\", ctx_r0.updateForm)(\"currentValue\", ctx_r0.kunde.nachname);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.updateForm.pristine || ctx_r0.updateForm.invalid);\n  }\n}\n/**\r\n * Komponente f&uuml;r das Tag <code>hs-update-kunde</code>\r\n */\n\n\nexport class UpdateKundeComponent {\n  // eslint-disable-next-line max-params\n  constructor(service, readService, titleService, router, route) {\n    this.service = service;\n    this.readService = readService;\n    this.titleService = titleService;\n    this.router = router;\n    this.route = route;\n\n    _UpdateKundeComponent_instances.add(this);\n\n    this.updateForm = new FormGroup({});\n    log.debug('UpdateKundeComponent.constructor()');\n  }\n\n  ngOnInit() {\n    var _a;\n\n    const id = (_a = this.route.snapshot.paramMap.get('id')) !== null && _a !== void 0 ? _a : undefined;\n    this.readService.findById(id).pipe(first(), tap(result => {\n      __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_setProps).call(this, result);\n\n      log.debug('UpdateKundeComponent.ngOnInit: kunde=', this.kunde);\n    })).subscribe();\n  }\n  /**\r\n   * Die aktuellen Stammdaten f&uuml;r das angezeigte Kunde-Objekt\r\n   * zur&uuml;ckschreiben.\r\n   * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\r\n   *         zu konsumieren.\r\n   */\n\n\n  onSubmit() {\n    if (this.updateForm.pristine || this.kunde === undefined) {\n      log.debug('UpdateKundeComponent.onSubmit: keine Aenderungen');\n      return;\n    }\n\n    const {\n      nachname\n    } = this.updateForm.value;\n    const {\n      kunde,\n      service\n    } = this; // datum, preis und rabatt koennen im Formular nicht geaendert werden\n\n    kunde.nachname = nachname;\n    log.debug('UpdateKundeComponent.onSubmit: kunde=', kunde);\n    service.update(kunde).pipe(first(), tap(result => __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_handleUpdateResult).call(this, result))).subscribe({\n      next: () => __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_navigateHome).call(this)\n    });\n    return false;\n  }\n\n}\n_UpdateKundeComponent_instances = new WeakSet(), _UpdateKundeComponent_setProps = function _UpdateKundeComponent_setProps(result) {\n  if (result instanceof FindError) {\n    __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_handleFindError).call(this, result);\n\n    return;\n  }\n\n  this.kunde = result;\n  this.errorMsg = undefined;\n  const titel = `Aktualisieren ${this.kunde.id}`;\n  this.titleService.setTitle(titel);\n}, _UpdateKundeComponent_handleFindError = function _UpdateKundeComponent_handleFindError(err) {\n  const {\n    statuscode\n  } = err;\n  log.debug('UpdateKundeComponent.#handleError: statuscode=', statuscode);\n  this.kunde = undefined;\n\n  switch (statuscode) {\n    case 404\n    /* NotFound */\n    :\n      this.errorMsg = 'Kein Kunde gefunden.';\n      break;\n\n    case 429\n    /* TooManyRequests */\n    :\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n\n    case 504\n    /* GatewayTimeout */\n    :\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n}, _UpdateKundeComponent_handleUpdateResult = function _UpdateKundeComponent_handleUpdateResult(result) {\n  if (!(result instanceof UpdateError)) {\n    return;\n  }\n\n  const {\n    statuscode\n  } = result;\n  log.debug('UpdateStammdatenComponent.#handleError: statuscode=', statuscode);\n\n  switch (statuscode) {\n    case 422\n    /* UnprocessableEntity */\n    :\n      {\n        const {\n          cause\n        } = result; // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n        this.errorMsg = cause instanceof HttpErrorResponse ? cause.error : JSON.stringify(cause);\n        break;\n      }\n\n    case 429\n    /* TooManyRequests */\n    :\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n\n    case 504\n    /* GatewayTimeout */\n    :\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n\n  log.debug('UpdateKundeComponent.#handleError: errorMsg=', this.errorMsg);\n}, _UpdateKundeComponent_navigateHome = /*#__PURE__*/function () {\n  var _UpdateKundeComponent_navigateHome2 = _asyncToGenerator(function* () {\n    yield this.router.navigate(['/']);\n  });\n\n  function _UpdateKundeComponent_navigateHome() {\n    return _UpdateKundeComponent_navigateHome2.apply(this, arguments);\n  }\n\n  return _UpdateKundeComponent_navigateHome;\n}();\n\nUpdateKundeComponent.ɵfac = function UpdateKundeComponent_Factory(t) {\n  return new (t || UpdateKundeComponent)(i0.ɵɵdirectiveInject(i1.KundeWriteService), i0.ɵɵdirectiveInject(i1.KundeReadService), i0.ɵɵdirectiveInject(i2.Title), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n};\n\nUpdateKundeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UpdateKundeComponent,\n  selectors: [[\"hs-update-kunde\"]],\n  decls: 2,\n  vars: 2,\n  consts: [[\"class\", \"mt-1 ms-1\", 4, \"ngIf\"], [3, \"text\"], [1, \"mt-1\", \"ms-1\"], [1, \"mt-2\", \"ms-2\"], [\"role\", \"form\", 3, \"formGroup\", \"submit\"], [3, \"updateForm\", \"currentValue\"], [1, \"row\"], [1, \"col\", \"offset-2\", \"gy-3\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"material-icons\"], [1, \"ms-1\"]],\n  template: function UpdateKundeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, UpdateKundeComponent_section_0_Template, 13, 5, \"section\", 0);\n      i0.ɵɵelement(1, \"hs-error-message\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.kunde);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"text\", ctx.errorMsg);\n    }\n  },\n  dependencies: [i4.NgIf, i5.ErrorMessageComponent, i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.FormGroupDirective, i7.UpdateNachnameComponent],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["FindError","UpdateError","HttpErrorResponse","first","tap","FormGroup","log","i0","ctx_r0","UpdateKundeComponent","constructor","service","readService","titleService","router","route","debug","ngOnInit","id","snapshot","paramMap","get","_a","undefined","findById","pipe","result","__classPrivateFieldGet","_UpdateKundeComponent_instances","_UpdateKundeComponent_setProps","call","kunde","subscribe","onSubmit","updateForm","pristine","nachname","value","update","_UpdateKundeComponent_handleUpdateResult","next","_UpdateKundeComponent_navigateHome","_UpdateKundeComponent_handleFindError","errorMsg","titel","setTitle","err","statuscode","error","cause","JSON","stringify","navigate","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Student\\Documents\\SWE\\kundeweb\\kundeweb\\src\\app\\kunde\\update-kunde\\update-kunde.component.ts","C:\\Users\\Student\\Documents\\SWE\\kundeweb\\kundeweb\\src\\app\\kunde\\update-kunde\\update-kunde.component.html"],"sourcesContent":["import { ActivatedRoute, Router } from '@angular/router'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { Component, type OnInit } from '@angular/core';\n/* eslint-disable @typescript-eslint/consistent-type-imports */\nimport {\n    FindError,\n    type Kunde,\n    KundeReadService,\n    KundeWriteService,\n    UpdateError,\n} from '../shared';\n/* eslint-enable @typescript-eslint/consistent-type-imports */\nimport { HttpErrorResponse, HttpStatusCode } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport { Title } from '@angular/platform-browser'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport log from 'loglevel';\n\n/**\n * Komponente f&uuml;r das Tag <code>hs-update-kunde</code>\n */\n@Component({\n    selector: 'hs-update-kunde',\n    templateUrl: './update-kunde.component.html',\n})\nexport class UpdateKundeComponent implements OnInit {\n    kunde: Kunde | undefined;\n\n    readonly updateForm = new FormGroup({});\n\n    errorMsg: string | undefined;\n\n    // eslint-disable-next-line max-params\n    constructor(\n        private readonly service: KundeWriteService,\n        private readonly readService: KundeReadService,\n        private readonly titleService: Title,\n        private readonly router: Router,\n        private readonly route: ActivatedRoute,\n    ) {\n        log.debug('UpdateKundeComponent.constructor()');\n    }\n\n    ngOnInit() {\n        const id = this.route.snapshot.paramMap.get('id') ?? undefined;\n\n        this.readService\n            .findById(id)\n            .pipe(\n                first(),\n                tap(result => {\n                    this.#setProps(result);\n                    log.debug(\n                        'UpdateKundeComponent.ngOnInit: kunde=',\n                        this.kunde,\n                    );\n                }),\n            )\n            .subscribe();\n    }\n\n    /**\n     * Die aktuellen Stammdaten f&uuml;r das angezeigte Kunde-Objekt\n     * zur&uuml;ckschreiben.\n     * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\n     *         zu konsumieren.\n     */\n    onSubmit() {\n        if (this.updateForm.pristine || this.kunde === undefined) {\n            log.debug('UpdateKundeComponent.onSubmit: keine Aenderungen');\n            return;\n        }\n\n        const { nachname } = this.updateForm.value as { nachname: string };\n        const { kunde, service } = this;\n        // datum, preis und rabatt koennen im Formular nicht geaendert werden\n        kunde.nachname = nachname;\n        log.debug('UpdateKundeComponent.onSubmit: kunde=', kunde);\n\n        service\n            .update(kunde)\n            .pipe(\n                first(),\n                tap(result => this.#handleUpdateResult(result)),\n            )\n            .subscribe({ next: () => this.#navigateHome() });\n        return false;\n    }\n\n    #setProps(result: FindError | Kunde) {\n        if (result instanceof FindError) {\n            this.#handleFindError(result);\n            return;\n        }\n\n        this.kunde = result;\n        this.errorMsg = undefined;\n\n        const titel = `Aktualisieren ${this.kunde.id}`;\n        this.titleService.setTitle(titel);\n    }\n\n    #handleFindError(err: FindError) {\n        const { statuscode } = err;\n        log.debug('UpdateKundeComponent.#handleError: statuscode=', statuscode);\n\n        this.kunde = undefined;\n\n        switch (statuscode) {\n            case HttpStatusCode.NotFound:\n                this.errorMsg = 'Kein Kunde gefunden.';\n                break;\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n    }\n\n    #handleUpdateResult(result: Kunde | UpdateError) {\n        if (!(result instanceof UpdateError)) {\n            return;\n        }\n\n        const { statuscode } = result;\n        log.debug(\n            'UpdateStammdatenComponent.#handleError: statuscode=',\n            statuscode,\n        );\n\n        switch (statuscode) {\n            case HttpStatusCode.UnprocessableEntity: {\n                const { cause } = result;\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this.errorMsg =\n                    cause instanceof HttpErrorResponse\n                        ? cause.error\n                        : JSON.stringify(cause);\n                break;\n            }\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n\n        log.debug(\n            'UpdateKundeComponent.#handleError: errorMsg=',\n            this.errorMsg,\n        );\n    }\n\n    async #navigateHome() {\n        await this.router.navigate(['/']);\n    }\n}\n","<section class=\"mt-1 ms-1\" *ngIf=\"kunde\">\n  <h4>Kunde {{ kunde.id }}:</h4>\n\n  <div class=\"mt-2 ms-2\">\n    <form [formGroup]=\"updateForm\" role=\"form\" (submit)=\"onSubmit()\">\n      <hs-update-nachname\n        [updateForm]=\"updateForm\"\n        [currentValue]=\"kunde.nachname\"\n      >\n      </hs-update-nachname>\n\n      <div class=\"row\">\n        <div class=\"col offset-2 gy-3\">\n          <button\n            type=\"submit\"\n            class=\"btn btn-primary\"\n            [disabled]=\"updateForm.pristine || updateForm.invalid\"\n          >\n            <i class=\"material-icons\">check</i>\n            <span class=\"ms-1\">Stammdaten aktualisieren</span>\n          </button>\n        </div>\n      </div>\n    </form>\n  </div>\n</section>\n\n<hs-error-message [text]=\"errorMsg\"></hs-error-message>\n"]},"metadata":{},"sourceType":"module"}