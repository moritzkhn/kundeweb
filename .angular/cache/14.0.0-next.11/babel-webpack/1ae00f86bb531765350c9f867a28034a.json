{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Student/Documents/SWE/kundeweb/kundeweb/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _CreateKundeComponent_instances, _CreateKundeComponent_setProps, _CreateKundeComponent_handleError, _CreateKundeComponent_navigateHome;\n\nimport { __classPrivateFieldGet } from \"tslib\";\nimport { toKunde } from './kundeForm';\nimport { SaveError } from '../shared'; // eslint-disable-line @typescript-eslint/consistent-type-imports\n\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport log from 'loglevel';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/platform-browser\";\n\nfunction CreateKundeComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"div\", 15)(2, \"span\", 16)(3, \"i\", 10);\n    i0.ɵɵtext(4, \"warning\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"strong\", 17);\n    i0.ɵɵtext(6, \" Wenn Sie die Seite jetzt verlassen, verlieren Sie Ihre eingegebenen Daten. \");\n    i0.ɵɵelementEnd()()()();\n  }\n}\n/**\r\n * Komponente mit dem Tag &lt;create-kunde&gt;, um das Erfassungsformular\r\n * f&uuml;r ein neuen Kunde zu realisieren.\r\n */\n\n\nexport class CreateKundeComponent {\n  constructor(service, router, titleService) {\n    this.service = service;\n    this.router = router;\n    this.titleService = titleService;\n\n    _CreateKundeComponent_instances.add(this);\n\n    this.createForm = new FormGroup({});\n    this.showWarning = false;\n    this.fertig = false;\n    this.errorMsg = undefined;\n    log.debug('CreateKundeComponent.constructor: Injizierter Router:', router);\n  }\n\n  ngOnInit() {\n    this.titleService.setTitle('Neuer Kunde');\n  }\n  /**\r\n   * Die Methode <code>onSubmit</code> realisiert den Event-Handler, wenn das\r\n   * Formular abgeschickt wird, um einen neuen Kunden anzulegen.\r\n   * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\r\n   *         zu konsumieren.\r\n   */\n\n\n  onSubmit() {\n    // In einem Control oder in einer FormGroup gibt es u.a. folgende\n    // Properties\n    //    value     JSON-Objekt mit den IDs aus der FormGroup als\n    //              Schluessel und den zugehoerigen Werten\n    //    errors    Map<string,any> mit den Fehlern, z.B. {'required': true}\n    //    valid/invalid     fuer valide Werte\n    //    dirty/pristine    falls der Wert geaendert wurde\n    if (this.createForm.invalid) {\n      log.debug('CreateKundeComponent.onSave: Validierungsfehler', this.createForm);\n    }\n\n    const kundeForm = this.createForm.value;\n    const neuerKunde = toKunde(kundeForm);\n    log.debug('CreateKundeComponent.onSave: neuerKunde=', neuerKunde);\n    this.service.save(neuerKunde).pipe( // 1. Datensatz empfangen und danach implizites \"unsubscribe\"\n    first(), tap(result => __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_setProps).call(this, result))) // asynchrone Funktionen nur bei subscribe, nicht bei tap\n    .subscribe({\n      next: () => __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_navigateHome).call(this)\n    });\n  }\n\n}\n_CreateKundeComponent_instances = new WeakSet(), _CreateKundeComponent_setProps = function _CreateKundeComponent_setProps(result) {\n  if (result instanceof SaveError) {\n    __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_handleError).call(this, result);\n\n    return;\n  }\n\n  this.fertig = true;\n  this.showWarning = false;\n  this.errorMsg = undefined;\n  const id = result;\n  log.debug('CreateKundeComponent.#setProps: id=', id);\n}, _CreateKundeComponent_handleError = function _CreateKundeComponent_handleError(err) {\n  const {\n    statuscode\n  } = err;\n  log.debug(`CreateKundeComponent.#handleError: statuscode=${statuscode}, err=`, err);\n\n  switch (statuscode) {\n    case 422\n    /* UnprocessableEntity */\n    :\n      {\n        const {\n          cause\n        } = err; // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n\n        this.errorMsg = cause instanceof HttpErrorResponse ? cause.error : JSON.stringify(cause);\n        break;\n      }\n\n    case 429\n    /* TooManyRequests */\n    :\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n\n    case 504\n    /* GatewayTimeout */\n    :\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n}, _CreateKundeComponent_navigateHome = /*#__PURE__*/function () {\n  var _CreateKundeComponent_navigateHome2 = _asyncToGenerator(function* () {\n    if (this.errorMsg === undefined) {\n      log.debug('CreateKundeComponent.#navigateHome: Navigation');\n      yield this.router.navigate(['/']);\n    }\n  });\n\n  function _CreateKundeComponent_navigateHome() {\n    return _CreateKundeComponent_navigateHome2.apply(this, arguments);\n  }\n\n  return _CreateKundeComponent_navigateHome;\n}();\n\nCreateKundeComponent.ɵfac = function CreateKundeComponent_Factory(t) {\n  return new (t || CreateKundeComponent)(i0.ɵɵdirectiveInject(i1.KundeWriteService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.Title));\n};\n\nCreateKundeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CreateKundeComponent,\n  selectors: [[\"hs-create-kunde\"]],\n  decls: 30,\n  vars: 16,\n  consts: [[1, \"card\"], [1, \"card-header\"], [1, \"ms-1\", \"fw-bold\"], [1, \"card-body\"], [\"role\", \"form\", 3, \"formGroup\", \"submit\"], [\"class\", \"row has-warning mb-4\", 4, \"ngIf\"], [3, \"createForm\"], [1, \"row\"], [1, \"col\", \"offset-2\", \"gy-3\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"material-icons\"], [1, \"ms-1\"], [1, \"mt-3\"], [3, \"text\"], [1, \"row\", \"has-warning\", \"mb-4\"], [1, \"col\", \"col-12\", \"form-control-feedback\"], [1, \"alert\", \"alert-warning\"], [1, \"text-help\", \"ms-1\"]],\n  template: function CreateKundeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"span\", 2);\n      i0.ɵɵtext(3, \"Neuer Kunde\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"form\", 4);\n      i0.ɵɵlistener(\"submit\", function CreateKundeComponent_Template_form_submit_5_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵtemplate(6, CreateKundeComponent_div_6_Template, 7, 0, \"div\", 5);\n      i0.ɵɵelement(7, \"hs-create-username\", 6)(8, \"hs-create-password\", 6)(9, \"hs-create-nachname\", 6)(10, \"hs-create-email\", 6)(11, \"hs-create-geburtsdatum\", 6)(12, \"hs-create-plz\", 6)(13, \"hs-create-ort\", 6)(14, \"hs-create-kategorie\", 6)(15, \"hs-create-newsletter\", 6)(16, \"hs-create-geschlecht\", 6)(17, \"hs-create-familienstand\", 6)(18, \"hs-create-interessen\", 6);\n      i0.ɵɵelementStart(19, \"div\", 7)(20, \"div\", 8)(21, \"button\", 9)(22, \"i\", 10);\n      i0.ɵɵtext(23, \"check\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"span\", 11);\n      i0.ɵɵtext(25, \"Jetzt anlegen\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(26, \"small\");\n      i0.ɵɵtext(27, \"* sind Pflichtfelder\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(28, \"div\", 12);\n      i0.ɵɵelement(29, \"hs-error-message\", 13);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"formGroup\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showWarning);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", ctx.createForm.invalid);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"text\", ctx.errorMsg);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["toKunde","SaveError","HttpErrorResponse","first","tap","FormGroup","log","i0","CreateKundeComponent","constructor","service","router","titleService","undefined","debug","ngOnInit","setTitle","onSubmit","createForm","invalid","kundeForm","value","neuerKunde","save","pipe","result","__classPrivateFieldGet","_CreateKundeComponent_instances","_CreateKundeComponent_setProps","call","subscribe","next","_CreateKundeComponent_navigateHome","_CreateKundeComponent_handleError","fertig","showWarning","errorMsg","id","err","statuscode","cause","error","JSON","stringify","navigate","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Student\\Documents\\SWE\\kundeweb\\kundeweb\\src\\app\\kunde\\create-kunde\\create-kunde.component.ts","C:\\Users\\Student\\Documents\\SWE\\kundeweb\\kundeweb\\src\\app\\kunde\\create-kunde\\create-kunde.component.html"],"sourcesContent":["import { type KundeForm, toKunde } from './kundeForm';\nimport { KundeWriteService, SaveError } from '../shared'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { Component, type OnInit } from '@angular/core';\nimport { HttpErrorResponse, HttpStatusCode } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport { Router } from '@angular/router'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { Title } from '@angular/platform-browser'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport log from 'loglevel';\n\n/**\n * Komponente mit dem Tag &lt;create-kunde&gt;, um das Erfassungsformular\n * f&uuml;r ein neuen Kunde zu realisieren.\n */\n@Component({\n    selector: 'hs-create-kunde',\n    templateUrl: './create-kunde.component.html',\n})\nexport class CreateKundeComponent implements OnInit {\n    readonly createForm = new FormGroup({});\n\n    showWarning = false;\n\n    fertig = false;\n\n    errorMsg: string | undefined = undefined;\n\n    constructor(\n        private readonly service: KundeWriteService,\n        private readonly router: Router,\n        private readonly titleService: Title,\n    ) {\n        log.debug(\n            'CreateKundeComponent.constructor: Injizierter Router:',\n            router,\n        );\n    }\n\n    ngOnInit() {\n        this.titleService.setTitle('Neuer Kunde');\n    }\n\n    /**\n     * Die Methode <code>onSubmit</code> realisiert den Event-Handler, wenn das\n     * Formular abgeschickt wird, um einen neuen Kunden anzulegen.\n     * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\n     *         zu konsumieren.\n     */\n    onSubmit() {\n        // In einem Control oder in einer FormGroup gibt es u.a. folgende\n        // Properties\n        //    value     JSON-Objekt mit den IDs aus der FormGroup als\n        //              Schluessel und den zugehoerigen Werten\n        //    errors    Map<string,any> mit den Fehlern, z.B. {'required': true}\n        //    valid/invalid     fuer valide Werte\n        //    dirty/pristine    falls der Wert geaendert wurde\n\n        if (this.createForm.invalid) {\n            log.debug(\n                'CreateKundeComponent.onSave: Validierungsfehler',\n                this.createForm,\n            );\n        }\n\n        const kundeForm = this.createForm.value as KundeForm;\n        const neuerKunde = toKunde(kundeForm);\n        log.debug('CreateKundeComponent.onSave: neuerKunde=', neuerKunde);\n\n        this.service\n            .save(neuerKunde)\n            .pipe(\n                // 1. Datensatz empfangen und danach implizites \"unsubscribe\"\n                first(),\n                tap(result => this.#setProps(result)),\n            )\n            // asynchrone Funktionen nur bei subscribe, nicht bei tap\n            .subscribe({ next: () => this.#navigateHome() });\n    }\n\n    #setProps(result: SaveError | string) {\n        if (result instanceof SaveError) {\n            this.#handleError(result);\n            return;\n        }\n\n        this.fertig = true;\n        this.showWarning = false;\n        this.errorMsg = undefined;\n\n        const id = result;\n        log.debug('CreateKundeComponent.#setProps: id=', id);\n    }\n\n    #handleError(err: SaveError) {\n        const { statuscode } = err;\n        log.debug(\n            `CreateKundeComponent.#handleError: statuscode=${statuscode}, err=`,\n            err,\n        );\n\n        switch (statuscode) {\n            case HttpStatusCode.UnprocessableEntity: {\n                const { cause } = err;\n                // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this.errorMsg =\n                    cause instanceof HttpErrorResponse\n                        ? cause.error\n                        : JSON.stringify(cause);\n                break;\n            }\n\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n    }\n\n    async #navigateHome() {\n        if (this.errorMsg === undefined) {\n            log.debug('CreateKundeComponent.#navigateHome: Navigation');\n            await this.router.navigate(['/']);\n        }\n    }\n}\n","<!--\n    Copyright (C) 2015 - present Juergen Zimmermann, Hochschule Karlsruhe\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-->\n<div class=\"card\">\n  <div class=\"card-header\">\n    <span class=\"ms-1 fw-bold\">Neuer Kunde</span>\n  </div>\n\n  <div class=\"card-body\">\n    <!--\n          Template-Syntax:\n              [formGroup]=\"createForm\"  fuer Input (= Property Binding)\n                                        d.h. formGroup fuer Attr. createForm\n              (submit)=\"...()\"  fuer Output (= Event Binding)\n                                d.h. Ereignis submit an ...() anbinden\n              Definition von Attributnamen gemaess HTML: Attribute names\n              must consist of one or more characters other than the\n              space characters, U+0000 NULL, \"\"\", \"'\", \">\", \"/\", \"=\",\n              the control characters, and any characters that are not\n              defined by Unicode.\n              https://github.com/angular/angular/issues/6786\n      -->\n    <!-- dynamisches Formular mit Validierung durch formGroup -->\n    <!-- https://angular.io/guide/reactive-forms -->\n    <form [formGroup]=\"createForm\" role=\"form\" (submit)=\"onSubmit()\">\n      <div class=\"row has-warning mb-4\" *ngIf=\"showWarning\">\n        <div class=\"col col-12 form-control-feedback\">\n          <span class=\"alert alert-warning\">\n            <i class=\"material-icons\">warning</i>\n            <strong class=\"text-help ms-1\">\n              Wenn Sie die Seite jetzt verlassen, verlieren Sie Ihre\n              eingegebenen Daten.\n            </strong>\n          </span>\n        </div>\n      </div>\n\n      <hs-create-username [createForm]=\"createForm\"></hs-create-username>\n      <hs-create-password [createForm]=\"createForm\"></hs-create-password>\n      <hs-create-nachname [createForm]=\"createForm\"></hs-create-nachname>\n      <hs-create-email [createForm]=\"createForm\"></hs-create-email>\n      <hs-create-geburtsdatum\n        [createForm]=\"createForm\"\n      ></hs-create-geburtsdatum>\n      <hs-create-plz [createForm]=\"createForm\"></hs-create-plz>\n      <hs-create-ort [createForm]=\"createForm\"></hs-create-ort>\n      <hs-create-kategorie [createForm]=\"createForm\"></hs-create-kategorie>\n      <hs-create-newsletter [createForm]=\"createForm\"></hs-create-newsletter>\n      <hs-create-geschlecht [createForm]=\"createForm\"></hs-create-geschlecht>\n      <hs-create-familienstand\n        [createForm]=\"createForm\"\n      ></hs-create-familienstand>\n      <hs-create-interessen [createForm]=\"createForm\"></hs-create-interessen>\n      <div class=\"row\">\n        <div class=\"col offset-2 gy-3\">\n          <!-- [disabled]=\"...\" fuer Input (= Property Binding) -->\n          <button\n            type=\"submit\"\n            class=\"btn btn-primary\"\n            [disabled]=\"createForm.invalid\"\n          >\n            <i class=\"material-icons\">check</i>\n            <span class=\"ms-1\">Jetzt anlegen</span>\n          </button>\n        </div>\n      </div>\n    </form>\n\n    <small>* sind Pflichtfelder</small>\n  </div>\n</div>\n\n<div class=\"mt-3\">\n  <hs-error-message [text]=\"errorMsg\"></hs-error-message>\n</div>\n"]},"metadata":{},"sourceType":"module"}